---
title: 'Create Session'
api: 'POST https://api.payviox.com/session'
description: 'Create a new payment session'
authMethod: 'bearer'
---

## Overview

Creates a new payment session for your customer. The session ID can be used to redirect the customer to the payment page or to fetch available payment methods.

<Note>
  Payment sessions expire after 24 hours if no payment is initiated.
</Note>

## Authentication

This endpoint accepts both **Public API Key** (client-side) and **Secret API Key** (server-side). See [Authentication](/api/authentication) for details.

```bash
Authorization: Bearer YOUR_API_KEY
```

## Integration Modes

<Tabs>
  <Tab title="Client-side (SDK)">
    Use your **Public API Key** when creating sessions from the browser via the JavaScript SDK.
    
    - Client IP is **automatically captured** from the request
    - No need to provide the `ip` parameter
    - Ideal for: websites, single-page applications
    
    ```javascript
    const payviox = new Payviox('pk_live_xxxxxxxxxxxx');
    await payviox.createSession({ ... });
    ```
  </Tab>
  <Tab title="Server-side (API)">
    Use your **Secret API Key** when creating sessions from your backend server.
    
    - You can **optionally provide** the client's IP address via the `ip` parameter
    - If `ip` is provided, it will be validated when the user completes payment
    - If `ip` is not provided, no IP validation will occur
    - Ideal for: backend APIs, mobile app backends, server integrations
    
    ```bash
    curl https://api.payviox.com/session \
      -H "Authorization: Bearer sk_live_xxxxxxxxxxxx" \
      -d '{ "ip": "203.0.113.42", ... }'
    ```
    
    <Warning>
      When you provide an `ip` parameter, the payment page will verify that the user's IP matches. If there's a mismatch, the payment will be rejected with a **403 IP mismatch** error.
    </Warning>
  </Tab>
</Tabs>

## Request Body

<ParamField body="amount" type="integer" required>
  The payment amount in cents (e.g., 10000 = $100.00)
  
  **Minimum:** 100 (equivalent to $1.00)
</ParamField>

<ParamField body="currency" type="string" required>
  Three-letter ISO currency code (e.g., USD, EUR, GBP)
  
  **Note:** Currently only USD is supported
</ParamField>

<ParamField body="customer" type="string" required>
  Customer identifier. Can be an email, customer ID, or any unique identifier.
  
  **Example:** `"customer_abc123"` or `"user@example.com"`
</ParamField>

<ParamField body="order_id" type="string" required>
  Your unique order identifier. This will be included in webhooks.
</ParamField>

<ParamField body="items" type="array" required>
  Array of items being purchased
  
  <Expandable title="Item Object">
    <ParamField body="name" type="string" required>
      Name of the item
    </ParamField>
    
    <ParamField body="quantity" type="integer" required>
      Quantity of the item (minimum: 1)
    </ParamField>
    
    <ParamField body="price" type="integer" required>
      Price per unit in cents (minimum: 1)
    </ParamField>
  </Expandable>
</ParamField>

<ParamField body="description" type="string">
  Optional description of the payment
</ParamField>

<ParamField body="paymentMethodId" type="string">
  Force a specific payment method (optional). When provided, only this payment method will be available.
</ParamField>

<ParamField body="ip" type="string">
  **Server-side only.** The end-user's IP address.
  
  <Note>
    This parameter is only available when using your **Secret API Key**. When using the Public API Key, the IP is automatically captured from the request.
  </Note>
  
  **When to use:**
  - When creating sessions from your backend on behalf of a user
  - When you want IP validation at payment time
  
  **Example:** `"203.0.113.42"` or `"2001:db8::1"`
  
  <Warning>
    If provided, the IP will be validated when the user accesses the payment page. A mismatch will result in a **403 error**.
  </Warning>
</ParamField>

## Response

<ResponseField name="session_id" type="string">
  Unique identifier for the created session
</ResponseField>

## Example Requests

### Client-side Example (Public API Key)

<CodeGroup>

```bash cURL
curl https://api.payviox.com/session \
  -H "Authorization: Bearer pk_live_xxxxxxxxxxxx" \
  -H "Content-Type: application/json" \
  -X POST \
  -d '{
    "amount": 10000,
    "currency": "USD",
    "customer": "customer_abc123",
    "order_id": "order_12345",
    "description": "Premium subscription",
    "items": [
      {
        "name": "Premium Plan",
        "quantity": 1,
        "price": 10000
      }
    ]
  }'
```

```javascript JavaScript
const response = await fetch('https://api.payviox.com/session', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer pk_live_xxxxxxxxxxxx',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    amount: 10000,
    currency: 'USD',
    customer: 'customer_abc123',
    order_id: 'order_12345',
    description: 'Premium subscription',
    items: [
      {
        name: 'Premium Plan',
        quantity: 1,
        price: 10000
      }
    ]
  })
});

const data = await response.json();
console.log(data.session_id);
```

```python Python
import requests

url = 'https://api.payviox.com/session'
headers = {
    'Authorization': 'Bearer pk_live_xxxxxxxxxxxx',
    'Content-Type': 'application/json'
}

payload = {
    'amount': 10000,
    'currency': 'USD',
    'customer': 'customer_abc123',
    'order_id': 'order_12345',
    'description': 'Premium subscription',
    'items': [
        {
            'name': 'Premium Plan',
            'quantity': 1,
            'price': 10000
        }
    ]
}

response = requests.post(url, headers=headers, json=payload)
data = response.json()
print(data['session_id'])
```

```php PHP
<?php

$apiKey = 'pk_live_xxxxxxxxxxxx';
$url = 'https://api.payviox.com/session';

$data = [
    'amount' => 10000,
    'currency' => 'USD',
    'customer' => 'customer_abc123',
    'order_id' => 'order_12345',
    'description' => 'Premium subscription',
    'items' => [
        [
            'name' => 'Premium Plan',
            'quantity' => 1,
            'price' => 10000
        ]
    ]
];

$ch = curl_init($url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($data));
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Authorization: Bearer ' . $apiKey,
    'Content-Type: application/json'
]);

$response = curl_exec($ch);
curl_close($ch);

$result = json_decode($response, true);
echo $result['session_id'];
```

```ruby Ruby
require 'net/http'
require 'json'

uri = URI('https://api.payviox.com/session')
http = Net::HTTP.new(uri.host, uri.port)
http.use_ssl = true

request = Net::HTTP::Post.new(uri)
request['Authorization'] = 'Bearer pk_live_xxxxxxxxxxxx'
request['Content-Type'] = 'application/json'

request.body = {
  amount: 10000,
  currency: 'USD',
  customer: 'customer_abc123',
  order_id: 'order_12345',
  description: 'Premium subscription',
  items: [
    {
      name: 'Premium Plan',
      quantity: 1,
      price: 10000
    }
  ]
}.to_json

response = http.request(request)
result = JSON.parse(response.body)
puts result['session_id']
```

```go Go
package main

import (
    "bytes"
    "encoding/json"
    "fmt"
    "net/http"
)

func main() {
    url := "https://api.payviox.com/session"
    
    payload := map[string]interface{}{
        "amount":   10000,
        "currency": "USD",
        "customer": "customer_abc123",
        "order_id":    "order_12345",
        "description": "Premium subscription",
        "items": []map[string]interface{}{
            {
                "name":     "Premium Plan",
                "quantity": 1,
                "price":    10000,
            },
        },
    }
    
    jsonData, _ := json.Marshal(payload)
    
    req, _ := http.NewRequest("POST", url, bytes.NewBuffer(jsonData))
    req.Header.Set("Authorization", "Bearer pk_live_xxxxxxxxxxxx")
    req.Header.Set("Content-Type", "application/json")
    
    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()
    
    var result map[string]interface{}
    json.NewDecoder(resp.Body).Decode(&result)
    fmt.Println(result["session_id"])
}
```

</CodeGroup>

### Server-side Example (Secret API Key with IP)

When creating sessions from your backend, you can provide the client's IP address for fraud prevention:

<CodeGroup>

```bash cURL
curl https://api.payviox.com/session \
  -H "Authorization: Bearer sk_live_xxxxxxxxxxxx" \
  -H "Content-Type: application/json" \
  -X POST \
  -d '{
    "amount": 10000,
    "currency": "USD",
    "customer": "customer_abc123",
    "order_id": "order_12345",
    "description": "Premium subscription",
    "ip": "203.0.113.42",
    "items": [
      {
        "name": "Premium Plan",
        "quantity": 1,
        "price": 10000
      }
    ]
  }'
```

```javascript Node.js
// Server-side example (Express.js)
app.post('/create-payment', async (req, res) => {
  const clientIp = req.headers['x-forwarded-for'] || req.ip;
  
  const response = await fetch('https://api.payviox.com/session', {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer sk_live_xxxxxxxxxxxx',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      amount: 10000,
      currency: 'USD',
      customer: req.body.customer,
      order_id: 'order_' + Date.now(),
      description: 'Premium subscription',
      ip: clientIp, // Pass the client's real IP
      items: req.body.items
    })
  });
  
  const data = await response.json();
  res.json({ session_id: data.session_id });
});
```

```python Python (Flask)
from flask import Flask, request, jsonify
import requests

app = Flask(__name__)

@app.route('/create-payment', methods=['POST'])
def create_payment():
    # Get the client's real IP
    client_ip = request.headers.get('X-Forwarded-For', request.remote_addr)
    
    response = requests.post(
        'https://api.payviox.com/session',
        headers={
            'Authorization': 'Bearer sk_live_xxxxxxxxxxxx',
            'Content-Type': 'application/json'
        },
        json={
            'amount': 10000,
            'currency': 'USD',
            'customer': request.json['customer'],
            'order_id': f'order_{int(time.time())}',
            'description': 'Premium subscription',
            'ip': client_ip,  # Pass the client's real IP
            'items': request.json['items']
        }
    )
    
    return jsonify(response.json())
```

```php PHP (Laravel)
<?php

Route::post('/create-payment', function (Request $request) {
    // Get the client's real IP
    $clientIp = $request->header('X-Forwarded-For') ?? $request->ip();
    
    $response = Http::withHeaders([
        'Authorization' => 'Bearer sk_live_xxxxxxxxxxxx',
        'Content-Type' => 'application/json'
    ])->post('https://api.payviox.com/session', [
        'amount' => 10000,
        'currency' => 'USD',
        'customer' => $request->input('customer'),
        'order_id' => 'order_' . time(),
        'description' => 'Premium subscription',
        'ip' => $clientIp, // Pass the client's real IP
        'items' => $request->input('items')
    ]);
    
    return response()->json($response->json());
});
```

</CodeGroup>

<Tip>
  **Without IP parameter:** If you don't provide the `ip` parameter in server-side requests, no IP validation will be performed at payment time. This is useful when you can't reliably determine the client's IP.
</Tip>

## Example Response

<ResponseExample>

```json Success Response (201)
{
  "session_id": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"
}
```

</ResponseExample>

## Error Responses

<ResponseExample>

```json Missing Required Fields (400)
{
  "amount": [
    "The amount field is required."
  ],
  "currency": [
    "The currency field is required."
  ]
}
```

```json Amount Validation Error (400)
{
  "amount": [
    "The total amount does not match the sum of the items (calculated: 15000, received: 10000)"
  ]
}
```

```json Unauthorized (401)
{
  "error": "Unauthorized"
}
```

```json Invalid Payment Method (400)
{
  "error": "Payment method not found"
}
```

```json IP Mismatch (403) - At payment time
{
  "error": "IP mismatch",
  "message": "Request IP does not match session IP"
}
```

</ResponseExample>

<Note>
  The **IP mismatch** error occurs at payment time (not session creation) when the user's IP doesn't match the `ip` parameter provided during session creation. This is a fraud prevention measure.
</Note>

## Next Steps

After creating a session:

<CardGroup cols={2}>
  <Card
    title="Redirect Customer"
    icon="arrow-up-right-from-square"
    href="/sdk/integration/redirect"
  >
    Redirect the customer to the payment page using the session ID
  </Card>
  <Card
    title="Get Payment Methods"
    icon="credit-card"
    href="/api/endpoints/get-payment-methods"
  >
    Fetch available payment methods for the session
  </Card>
  <Card
    title="Dashboard"
    icon="chart-line"
    href="https://dashboard.payviox.com"
  >
    Monitor your payments in real-time
  </Card>
  <Card
    title="API Playground"
    icon="flask"
    href="/api/authentication#using-the-api-playground"
  >
    Test API calls directly from your browser
  </Card>
</CardGroup>

## Validation Rules

<AccordionGroup>
  <Accordion title="Amount Validation">
    - Minimum amount: 100 cents ($1.00)
    - Must be a positive integer
    - Total amount must equal the sum of all items (price Ã— quantity)
  </Accordion>

  <Accordion title="Items Validation">
    - At least one item is required
    - Each item must have a name, quantity, and price
    - Quantity must be at least 1
    - Price must be at least 1 cent
  </Accordion>

  <Accordion title="Order ID">
    - Must be unique per business
    - Used for tracking and webhooks
    - Recommended to use your internal order/transaction ID
  </Accordion>
</AccordionGroup>

